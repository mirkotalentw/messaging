from openai import OpenAI
import os
import streamlit as st
from dotenv import load_dotenv
 
load_dotenv()
openai_api_key = os.getenv('OPENAI_API_KEY')
 
if openai_api_key is None:
    raise ValueError("OPENAI_API_KEY environment variable not found.")
 
OpenAI.api_key = openai_api_key
client = OpenAI()
    
system_instruction = """
You are an HR assistant. Your task is to help with writing an email to a candidate who you want to reach out to.
The person who is writing the email is the HR manager of the company. The email should be written in a professional manner.
The person who is writing is {PERSON_NAME} working for {COMPANY_NAME}. The company is a {COMPANY_DESCRIPTION}.
Here is the position description: {JOB_DESCRIPTION}.
Max number of characters in the message: {MAX_MESSAGE_LENGTH}. Of course you can write a shorter message.
The message should be written in the format: {FORMAT}.
Also, the message should be written in the language: {LANG_OPTION}.

The user will provide the cv of the candidate you want to reach out to.

The output MUST be only the message that the HR manager will send to the candidate.
(You can ignore the email subject and anything below the message).
There shouldnt be any PLACEHOLDERS. The message should be complete and ready to be sent to the candidate.

AS I SAID NO PLACEHOLDERS: NO STUFF LIKE THIS EITHER [LinkedIn Profile: https://me.linkedin.com/in/ognjen]
"""

refinement_prompt = """
You are an HR assistant. Your task is to help with writing a message.
Here is the message:
{MESSAGE}
Please refine the message to make it more {REFINEMENT} - {REFINEMENT_DESC}.

The output MUST be only the message that the HR manager will send to the candidate. 
NO SUBJECT OR ANY OTHER TEXT SHOULD BE INCLUDED.
There shouldnt be any PLACEHOLDERS. The message should be complete and ready to be sent to the candidate.

AS I SAID NO PLACEHOLDERS: NO STUFF LIKE THIS EITHER [LinkedIn Profile: https://me.linkedin.com/in/ognjen]
""" 

REFINEMENTS = {
    "Casual": "A relaxed and friendly tone to make the recipient feel at ease. Great for breaking the ice or when communicating in a less formal context.",
    "Formal": "Professional and respectful tone, suitable for communicating in a business setting or when addressing individuals in senior positions.",
    "Personal": "Tailored specifically to the recipient by incorporating personal details, such as past experiences or shared connections, to make the message more relatable.",
    "Positive": "Emphasizes optimism and enthusiasm, aiming to create a motivating and encouraging tone that inspires action or engagement.",
    "Inclusive": "Focuses on making everyone feel valued, regardless of their background, using gender-neutral and diversity-friendly language to foster a sense of belonging.",
    "Shorter": "A more concise and to-the-point message, often necessary when brevity is key, such as when the recipient is busy or there are word-count limitations.",
    "Longer": "A more detailed and comprehensive message, providing additional context or information. Ideal when explaining complex topics, giving background on the company, or when more depth is needed to convey the message effectively.",
    "Initial Contact": "A message tailored for the first outreach.",
    "Follow-Up": "Slightly more persistent but respectful tone and structure.",
    "Final Reminder": "Polite but firm messaging for closing out the outreach process.",
    "Persuasive": "Tailored to encourage the candidate to engage or take action, ideal for convincing passive candidates to respond.",
    "Call to Action Focus": "Emphasize the action part of the message (e.g., scheduling a call, asking for a resume) to ensure it's clear and compelling.",
    "Storytelling": "Format the message with a narrative structure, which could resonate with candidates by telling a story about the company, role, or success stories within the team."
}


RESUMES = {
    "Data scientist - Mirko Kalezic": "{\"monthsInJob\":18,\"profileURL\":\"https://me.linkedin.com/in/mirko-kalezic-79a7a517a\",\"lastName\":\"Kalezic\",\"mobility\":5,\"education\":[{\"school\":\"University of Montenegro\",\"degree\":\"Master's degree - Computer Science\",\"periodStart\":\"2019-01-01T00:00:00.000Z\"},{\"school\":\"University of Montenegro\",\"degree\":\"Electrical and Electronics Engineering\",\"periodStart\":\"2014-01-01T00:00:00.000Z\",\"periodEnd\":\"2018-12-31T23:59:59.000Z\"}],\"gender\":\"m\",\"jobTitle\":\"Software Developer\",\"changeProbability\":65,\"bio\":\"I have finished a bachelor degree in electronics, telecommunications and computer sciences at Faculty of Electrical Engineering at University of Montenegro. After that continue studying and finished my specialist degree. Right now I am on Master studies of computer science writing my master thesis and working as well. Having a 3+ years of experience in field of machine learning in several projects and 2+ years of experience in software engineering (C#, .NET). \\nHave good knowledge of Python and C# as main programming languages. \\nUsing several frameworks as Tensorflow, Opencv, Keras, SciPy, NumPy, Scikit-Learn, Pandas...\\nAnd .NET in C#.\",\"monthsWorking\":60,\"hasEmail\":false,\"workingSince\":\"2019-01-01T00:00:00.000Z\",\"monthsEducation\":120,\"isScientist\":true,\"imageURL\":\"https://media.licdn.com/dms/image/C5603AQGrwl05M2UGCA/profile-displayphoto-shrink_200_200/0/1555423208594?e=2147483647&v=beta&t=pGQpbedtfAg5JUli9XZx3dEqQXl_BW3UInlGdLL4dEw\",\"company\":\"Noubis\",\"isStudent\":false,\"isRecruiter\":false,\"address\":{\"country\":\"Montenegro\",\"city\":\"Podgorica\",\"countryCode\":\"mne\",\"state\":\"Podgorica\"},\"isFreelancer\":false,\"hasFax\":false,\"jobs\":[{\"jobTitle\":\"Software Developer\",\"company\":\"Noubis\",\"location\":\"Podgorica, Montenegro\",\"industry\":\"consumer goods and retail\",\"periodStart\":\"2022-07-01T00:00:00.000Z\",\"periodEnd\":null,\"industryName\":\"Consumer Goods and Retail\",\"industryCode\":\"009\"},{\"industryName\":\"IT and Internet\",\"jobTitle\":\"Software Engineer\",\"company\":\"DataLab\",\"industry\":\"IT and internet\",\"periodStart\":\"2021-01-01T00:00:00.000Z\",\"periodEnd\":\"2022-07-31T23:59:59.000Z\",\"industryCode\":\"002\"},{\"jobTitle\":\"Data Scientist\",\"company\":\"Robot Code\",\"periodStart\":\"2020-01-01T00:00:00.000Z\",\"periodEnd\":\"2021-01-31T23:59:59.000Z\"}],\"isExecutive\":false,\"fullName\":\"Mirko Kalezic\",\"inJobSince\":\"2022-07-01T00:00:00.000Z\",\"firstName\":\"Mirko\",\"previousCompanies\":[\"DataLab\",\"Robot Code\",\"omninext\"],\"changeProbabilityToo\":50,\"name\":\"Mirko Kalezic\",\"hasPhone\":false,\"previousJobTitles\":[\"Software Engineer\",\"Data Scientist\",\"Machine Learning Scientist Junior\"],\"location\":\"Podgorica, Montenegro\",\"_class\":\"linkedin\",\"educationSince\":\"2014-01-01T00:00:00.000Z\",\"isConsultant\":false,\"_id\":\"60bc00447d25167410f41e0e\",\"relevance\":100,\"links\":[{\"url\":\"http://me.linkedin.com/in/mirko-kalezic-79a7a517a\",\"platform\":\"linkedin\"}]}",
    "Product owner - Ivana Kampel": "{'_id': '66daf0cd03a9fa4e1eb21599', 'profileURL': 'https://www.xing.com/profile/Ivana_Kampel', 'lastName': 'Kampel', 'mobility': 5, 'gender': 'f', 'jobTitle': 'Product Owner', 'changeProbability': 45, 'industry': 'Product Owner, Talentwunder GmbH', 'geoPoint': {'lon': -111.184535, 'lat': 45.773279}, 'skills': ['Project Management', 'Business Development'], 'hasEmail': False, 'lastUpdated': '2024-09-06T12:09:06.394Z', 'isScientist': False, 'imageURL': 'https://profile-images.xing.com/users/d95176d68dc630fea87b733dd91569b8-1/image.256x256.jpg', 'dateCreatedAt': '2024-09-06T12:08:45.517Z', 'company': 'Talentwunder GmbH', 'isStudent': False, 'isRecruiter': False, 'altIds': ['66daf0cd03a9fa4e1eb21599', 'aHR0cHM6Ly93d3cueGluZy5jb20vcHJvZmlsZS9JdmFuYV9LYW1wZWw'], 'address': {'country': 'United States', 'city': 'Belgrade', 'countryCode': 'us', 'state': 'Montana'}, 'lastScraped': '2024-09-06T12:08:47.594Z', 'scrapeSuccessCounter': 1, 'isFreelancer': False, 'jobs': [{'industryName': 'HR Services', 'jobTitle': 'Product Owner', 'company': 'Talentwunder GmbH', 'industry': 'HR services', 'companyURL': 'https://www.xing.com/pages/talentwundergmbh', 'industryCode': '001'}], 'hasFax': False, 'isExecutive': False, 'fullName': 'Ivana Kampel', 'handle': 'ivana_kampel', 'firstName': 'Ivana', 'ml5': {'similarProfiles': {'encoding': ['pos0cluster16', 'pos1cluster31', 'pos2cluster24', 'pos3cluster26', 'pos4cluster2', 'pos5cluster14', 'pos6cluster21', 'pos7cluster8', 'pos8cluster30', 'pos9cluster21', 'pos10cluster3', 'pos11cluster31', 'pos12cluster5', 'pos13cluster30', 'pos14cluster27', 'pos15cluster11', 'pos16cluster12', 'pos17cluster21', 'pos18cluster24', 'pos19cluster28']}, 'profileQuality': 1}, 'name': 'Ivana Kampel', 'hasPhone': False, 'relevantLinksCount': 0, 'location': 'Belgrade, Serbia', '_class': 'xing', 'dateScrapedAtList': ['2024-09-06T12:08:47.594Z'], 'isConsultant': False, '_cab_report': 'matched'}",
    "Marketing manager - Regina Dank": "{'_id': '5f3a7e4fc77b3e76bb7be13e', 'monthsInJob': 11, 'profileURL': 'https://de.linkedin.com/in/regina-dank', 'lastName': 'Dank', 'mobility': 5, 'education': [{'study': 'Marketing, Vertrieb, Medien', 'school': 'Technische Hochschule Ingolstadt', 'degree': 'Master of Arts (M.A.)'}, {'study': 'Internationale Wirtschaftskommunikation', 'school': 'Internationale Hochschule SDI München', 'degree': 'Bachelor of Arts (B.A.)'}, {'study': 'LK Englisch und Französisch', 'school': 'Gymnasium Bruckmühl', 'degree': 'Abitur'}], 'gender': 'f', 'jobTitle': 'Teamlead Vertriebsmarketing', 'changeProbability': 55, 'geoPoint': {'lon': 11.4038717, 'lat': 48.9467562}, 'recommendations': [{'name': '“I’m happy to have worked closely with Regina for over a year on brand, marketing and communication initiatives for EY wavespace in GSA. I got to know her as a creative, open and reliable colleague who took both internal and external communication to the next level through inspiring content (e.g. video productions) and thus contributed to our pioneering role.\n\nEven in challenging situations, Regina always kept calm and sought and found the best possible solutions. Most importantly. Regina did not just deliver results and generated a positive impact for EY wavespace. She was also a valuable team member who could always be relied upon. She always looked and acted beyond her core responsibility by supporting other team members.  No question at all - Regina will be an asset to any organization she joins and I give her my full recommendation. I already congratulate the team and team lead who will have the opportunity collaborating with Regina. I wish her all the best on her future avenues and I hope our roads will cross again at some point. ”'}, {'name': '“Regina geht gleichzeitig strategisch, sowie mit dem nötigen Pragmatismus an neue Aufgaben heran und sorgt im Team dafür, dass Projekt im Rahmen der Deadline vollendet werden. Als Kollegin schätze ich Regina für ihren wertvollen 'Out-of-the-Box' Blick, um effiziente, erfolgreiche Lösungen zu finden. Als Teammitglied hält sie stets die Motivation oben und motiviert damit das gesamte Team. \n”'}], 'monthsWorking': 137, 'lastUpdated': '2024-01-17T15:59:57.384Z', 'hasEmail': False, 'workingSince': '2012-10-01T00:00:00.000Z', 'isScientist': False, 'imageURL': 'https://media.licdn.com/dms/image/C4D03AQHtfSw_UJIdNQ/profile-displayphoto-shrink_200_200/0/1634197219290?e=2147483647&v=beta&t=dbwK5PbdwW6XpucA_lcOn3jNM3rV5SfKoGqzSqMBrNI', 'company': 'RECUP', 'isStudent': False, 'isRecruiter': False, 'altIds': ['aHR0cHM6Ly9kZS5saW5rZWRpbi5jb20vaW4vcmVnaW5hLWRhbmstMmI4YTMzMTI2', 'aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3JlZ2luYS1kYW5rLTJiOGEzMzEyNg', '5ddfc31c677ae624702f3ba8', 'aHR0cHM6Ly9kZS5saW5rZWRpbi5jb20vaW4vcmVnaW5hLWRhbms', '5f3a7e4fc77b3e76bb7be13e'], 'address': {'country': 'Germany', 'countryCode': 'de', 'state': 'Bavaria'}, 'lastScraped': '2023-12-01T00:00:00.000Z', 'scrapeSuccessCounter': 2, 'isFreelancer': False, 'hasFax': False, 'jobs': [{'industryName': 'Other Sectors', 'jobTitle': 'Teamlead Vertriebsmarketing', 'company': 'RECUP', 'industry': 'other sectors', 'companyURL': 'https://www.linkedin.com/company/recupgmbh', 'periodStart': '2023-02-01T00:00:00.000Z', 'industryCode': '019'}, {'industryName': 'Other Sectors', 'jobTitle': 'Marketing Managerin', 'company': 'RECUP GmbH', 'industry': 'other sectors', 'companyURL': 'https://www.linkedin.com/company/recupgmbh', 'periodStart': '2021-10-01T00:00:00.000Z', 'industryCode': '019'}, {'industryName': 'Audit, Tax and Legal', 'jobTitle': 'Marketing Manager EY wavespace™ in Germany, Switzerland & Austria', 'company': 'EY', 'industry': 'audit, tax and legal', 'companyURL': 'https://www.linkedin.com/company/ernstandyoung', 'periodStart': '2020-03-01T00:00:00.000Z', 'industryCode': '005'}, {'industryName': 'Consultancy', 'jobTitle': 'Marketing Manager', 'company': 'etventure', 'industry': 'consultancy', 'companyURL': 'https://www.linkedin.com/company/etventure', 'periodStart': '2019-07-01T00:00:00.000Z', 'industryCode': '008'}, {'industryName': 'Consultancy', 'jobTitle': 'Junior Marketing Manager', 'company': 'etventure', 'industry': 'consultancy', 'companyURL': 'https://www.linkedin.com/company/etventure', 'periodStart': '2017-10-01T00:00:00.000Z', 'industryCode': '008'}, {'industryName': 'Industrial and Mechanical Engineering', 'jobTitle': 'Master-Student Marketing Communications', 'company': 'Bosch Security Systems', 'industry': 'industrial and mechanical engineering', 'companyURL': 'https://www.linkedin.com/company/bosch-security-systems', 'periodStart': '2016-08-01T00:00:00.000Z', 'industryCode': '015'}, {'industryName': 'Industrial and Mechanical Engineering', 'jobTitle': 'Werkstudent Corporate Communications', 'company': 'Bosch Security Systems', 'industry': 'industrial and mechanical engineering', 'companyURL': 'https://www.linkedin.com/company/bosch-security-systems', 'periodStart': '2015-10-01T00:00:00.000Z', 'industryCode': '015'}, {'industryName': 'Industrial and Mechanical Engineering', 'jobTitle': 'PreMaster Corporate Communications', 'company': 'Bosch Security Systems', 'industry': 'industrial and mechanical engineering', 'companyURL': 'https://www.linkedin.com/company/bosch-security-systems', 'periodStart': '2015-03-01T00:00:00.000Z', 'industryCode': '015'}, {'industryName': 'Industrial and Mechanical Engineering', 'jobTitle': 'Corporate Communications', 'company': 'Bosch Security Systems', 'industry': 'industrial and  mechanical engineering', 'companyURL': 'https://www.linkedin.com/company/bosch-security-systems', 'periodStart': '2014-11-01T00:00:00.000Z', 'industryCode': '015'}, {'industryName': 'Consumer Goods and Retail', 'jobTitle': 'Praktikum Media Relations', 'company': 'Airbus Defence and Space (Space Systems, Inc.)', 'industry': 'consumer goods and retail', 'companyURL': 'https://www.linkedin.com/company/airbus-defence-and-space-space-systems-inc-', 'periodStart': '2013-09-01T00:00:00.000Z', 'industryCode': '009'}, {'industryName': 'IT and Internet', 'jobTitle': 'Online Texter', 'company': 'limango GmbH - A member of the otto group', 'industry': 'IT and internet', 'companyURL': 'https://www.linkedin.com/company/limango-gmbh', 'periodStart': '2012-10-01T00:00:00.000Z', 'industryCode': '002'}], 'isExecutive': False, 'fullName': 'Regina Dank', 'handle': 'regina-dank', 'inJobSince': '2023-02-01T00:00:00.000Z', 'firstName': 'Regina', 'previousCompanies': ['RECUP GmbH', 'EY', 'etventure', 'Bosch Security Systems', 'Airbus Defence and Space (Space Systems, Inc.)', 'limango GmbH - A member of the otto group'], 'changeProbabilityToo': 59, 'name': 'Regina Dank', 'hasPhone': False, 'relevantLinksCount': 0, 'previousJobTitles': ['Marketing Managerin', 'Marketing Manager EY wavespace™ in Germany, Switzerland & Austria', 'Marketing Manager', 'Junior Marketing Manager', 'Master-Student Marketing Communications', 'Werkstudent Corporate Communications', 'PreMaster Corporate Communications', 'Corporate Communications', 'Praktikum Media Relations', 'Online Texter'], 'location': 'Bavaria, Germany', '_class': 'linkedin', 'dateScrapedAtList': ['2023-06-04T19:42:50.469Z', '2023-12-25T12:01:52.588Z'], 'isConsultant': False, '_cab_report': 'matched'}",
    "Human Resources Manager - Sebastian Schenke": "{'_id': '601eca75d0dbef67560b1cd8', 'profileURL': 'https://www.xing.com/profile/Sebastian_Schenke8', 'monthsInJob': 53, 'lastName': 'Schenke', 'mobility': 5, 'gender': 'm', 'jobTitle': 'Automobilkaufmann', 'changeProbability': 55, 'industry': 'Angestellt, Automobilkaufmann, Autohaus Badziong GmbH und Co. KG', 'geoPoint': {'lon': 6.8025409, 'lat': 50.9979888}, 'monthsWorking': 53, 'skills': ['Autohaus', 'Gebrauchtwagen', 'Leasing', 'VW', 'Finanzierung', 'Verkauf', 'PKW', 'Neuwagen', 'Zielstrebigkeit', 'Kundenorientierung'], 'hasEmail': False, 'lastUpdated': '2024-09-21T05:50:52.556Z', 'workingSince': '2020-04-01T00:00:00.000Z', 'isScientist': False, 'imageURL': 'https://profile-images.xing.com/images/149056ec98aba152d528f72ef9b5359d-1/sebastian-schenke.256x256.jpg', 'company': 'Autohaus Badziong GmbH und Co. KG', 'isStudent': False, 'isRecruiter': False, 'altIds': ['aHR0cHM6Ly93d3cueGluZy5jb20vcHJvZmlsZS9TZWJhc3RpYW5fU2NoZW5rZTg', '601eca75d0dbef67560b1cd8'], 'address': {'country': 'Germany', 'city': 'Pulheim', 'countryCode': 'de', 'state': 'North Rhine-Westphalia'}, 'lastScraped': '2024-08-30T15:56:22.318Z', 'scrapeSuccessCounter': 16, 'isFreelancer': False, 'jobs': [{'industryName': 'Automotive', 'jobTitle': 'Automobilkaufmann', 'company': 'Autohaus Badziong GmbH und Co. KG', 'industry': 'automotive engineering', 'companyURL': 'https://www.xing.com/pages/autohausbadzionggmbhundco-kg', 'periodStart': '2020-04-01T00:00:00.000Z', 'industryCode': '006'}], 'hasFax': False, 'isExecutive': False, 'fullName': 'Sebastian Schenke', 'handle': 'sebastian_schenke8', 'inJobSince': '2020-04-01T00:00:00.000Z', 'firstName': 'Sebastian', 'ml5': {'similarProfiles': {'encoding': ['pos0cluster18', 'pos1cluster8', 'pos2cluster12', 'pos3cluster22', 'pos4cluster0', 'pos5cluster0', 'pos6cluster6', 'pos7cluster30', 'pos8cluster6', 'pos9cluster12', 'pos10cluster19', 'pos11cluster14', 'pos12cluster30', 'pos13cluster12', 'pos14cluster3', 'pos15cluster2', 'pos16cluster16', 'pos17cluster0', 'pos18cluster7', 'pos19cluster10']}, 'profileQuality': 1}, 'name': 'Sebastian Schenke', 'hasPhone': False, 'relevantLinksCount': 0, 'location': 'Pulheim, Germany', '_class': 'xing', 'dateScrapedAtList': ['2023-02-22T02:55:54.572Z', '2023-03-13T16:14:41.153Z', '2023-04-03T07:49:39.399Z', '2023-04-16T10:19:39.657Z', '2023-04-22T08:20:08.727Z', '2023-04-28T23:58:13.589Z', '2023-05-04T14:40:43.653Z', '2023-06-16T11:44:35.857Z', '2023-07-15T13:38:49.424Z', '2023-08-27T18:28:59.410Z', '2023-11-09T06:59:56.410Z', '2023-12-23T03:50:04.917Z', '2024-02-08T00:56:51.307Z', '2024-04-21T11:46:35.513Z', '2024-07-04T10:40:32.606Z', '2024-08-30T15:56:22.318Z'], 'isConsultant': False}",
    "Graphic Designer - Marney Harlow": "{'_id': '5ebd69c04887874c82a92629', 'profileURL': 'https://www.behance.net/missmarneyg', 'lastName': 'Harlow', 'mobility': 5, 'gender': 'f', 'jobTitle': 'Graphic Designer, Illustrator', 'dateJoined': '2013-11-25T00:00:00.000Z', 'mobilityToo': 44, 'changeProbability': 45, 'geoPoint': {'lon': -104.985798, 'lat': 39.740959}, 'followingCount': 32, 'hasEmail': False, 'lastUpdated': '2023-02-18T05:27:07.405Z', 'isScientist': False, 'imageURL': 'https://mir-s3-cdn-cf.behance.net/user/230/a313244246833.5d407bed0f72f.jpg', 'links': [{'name': 'Website', 'url': 'https://marneyharlow.com'}, {'name': 'Instagram', 'url': 'http://instagram.com/marney_makes', 'platform': 'Instagram'}], 'isStudent': False, 'isRecruiter': False, 'altIds': ['5ebd69c04887874c82a92629', 'aHR0cHM6Ly93d3cuYmVoYW5jZS5uZXQvbWlzc21hcm5leWc'], 'address': {'country': 'United States', 'city': 'Denver', 'countryCode': 'usa', 'state': 'Colorado'}, 'lastScraped': '2023-02-17T23:10:57.517Z', 'scrapeSuccessCounter': 1, 'isFreelancer': False, 'jobs': [{'jobTitle': 'Graphic Designer, Illustrator', 'location': 'Denver, CO, USA'}], 'hasFax': False, 'isExecutive': False, 'fullName': 'Marney Harlow', 'handle': 'missmarneyg', 'firstName': 'Marney', 'ml5': {}, 'changeProbabilityToo': 29, 'name': 'Marney Harlow', 'hasPhone': False, 'location': 'Denver, CO, USA', '_class': 'behance', 'followersCount': 1, 'dateScrapedAtList': ['2023-02-17T23:10:57.517Z'], 'idInPortal': '4246833', 'isConsultant': False}",
    "Architect - Robert Majkic": "{'_id': '5ddfb9a7677ae6247009d6d6', 'monthsInJob': 39, 'education': [{'study': 'Architecture', 'school': 'Technische Universität Wien', 'degree': 'Master Studies', 'periodStart': '2014-01-01T00:00:00.000Z', 'periodEnd': '2016-12-31T23:59:59.000Z'}, {'study': 'Architecture', 'notes': 'Activities and Societies: Project architect in urbanism,architecture and research. occasionally worked at the Bureau, Legalization of resintatial and public buidings', 'school': 'University of Banjaluka', 'degree': 'Graduated Engineer of Architecture', 'periodStart': '2005-01-01T00:00:00.000Z', 'periodEnd': '2010-12-31T23:59:59.000Z'}], 'jobTitle': 'Architect bei STADT WIEN - Wiener Wohnen Kundenservice GmbH', 'bio': 'Als erfahrener Architekt mit mehr als 15 Jahren Berufserfahrung habe ich eine Leidenschaft für die Planung und Gestaltung von Gebäuden und Innenräumen. In meiner Karriere habe ich an einer Vielzahl von Projekten gearbeitet, von der Planung von Regulierungsplänen bis hin zur Inneneinrichtung von Seniorenimmobilien und öffentlichen Gebäuden. Meine Arbeit bei der Stadt Wien - Wiener Wohnen Kundenservice GmbH hat meine Fähigkeiten im Bereich der öffentlichen Bauten erweitert, während ich bei awp architekten und ingenieure zt gmbh wertvolle Erfahrungen in der Planung von Wohngebäuden sammeln konnte. Meine Arbeit bei Lima Design hat meine Kreativität und meine Fähigkeit, Innenräume zu gestalten, weiterentwickelt. Mit einer starken technischen Kompetenz und einem Auge für Design bin ich bestrebt, qualitativ hochwertige Lösungen für jedes Projekt zu liefern.', 'lastUpdated': '2024-04-30T20:27:59.210Z', 'monthsEducation': 109, 'isScientist': False, 'links': [{'name': 'Personal Website', 'url': 'http://robertmajkic.wix.com/robertmajkic'}], 'isRecruiter': False, 'lastScraped': '2024-04-10T13:27:03.604Z', 'scrapeSuccessCounter': 2, 'hasFax': False, 'handle': 'robert-majkic', 'inJobSince': '2021-01-01T00:00:00.000Z', 'firstName': 'Di', 'previousCompanies': ['awp architekten und ingenieure zt gmbh', 'Lima Design', 'Pflegeraum Mayerling GmbH', 'John W. McDougall Company, Inc.', 'Institute of Urbanism, Banja LukaProject architect in urbanism,architecture and research.', 'Architectural office 'Projekt' Banja Luka', 'Design bureau 'Kuća', Banja Luka'], 'name': 'Di Robert Majkic', 'relevantLinksCount': 0, 'previousJobTitles': ['Architect', 'Design von Inneneinrichtungen für Seniorenimmobilien', 'Architectural Division Draftsman', 'Project architect in urbanism,architecture and research', 'Internship', 'Project architect in planning and preparing tecnical documentation'], '_class': 'linkedin', 'educationSince': '2005-01-01T00:00:00.000Z', 'dateScrapedAtList': ['2024-01-09T21:28:50.495Z', '2024-04-10T13:27:03.604Z'], 'isConsultant': False, 'profileURL': 'https://at.linkedin.com/in/robert-majkic', 'lastName': 'Majkic', 'mobility': 45, 'gender': 'f', 'changeProbability': 85, 'industry': 'other sectors', 'geoPoint': {'lon': 16.3738189, 'lat': 48.2081743}, 'languagesString': 'Serbian sr English en German de Croatian hr', 'monthsWorking': 199, 'hasEmail': False, 'workingSince': '2004-02-01T00:00:00.000Z', 'imageURL': 'https://media.licdn.com/dms/image/D4E03AQFykGu1TKVgaA/profile-displayphoto-shrink_200_200/0/1690574726988?e=2147483647&v=beta&t=UO4R3DrOsTXk2mERRlLuo0CovFxk9grRvIy8LFXeUiE', 'previousLocations': ['Banja Luka, Bosnia Hercegovina', 'Banja Luka, Republic of Srpska, Bosnia Herzegovina'], 'company': 'Stadt Wien - Wiener Wohnen Kundenservice GmbH', 'isStudent': False, 'altIds': ['aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3JvYmVydC1tYWpraWMtNDc0MDQzOGI', '5ddfb9a7677ae6247009d6d6', 'aHR0cHM6Ly9hdC5saW5rZWRpbi5jb20vaW4vcm9iZXJ0LW1hamtpYw'], 'address': {'country': 'Austria', 'city': 'Vienna', 'countryCode': 'at', 'state': 'Vienna'}, 'languages': [{'levelCode': 5, 'code': 'sr', 'level': 'Native or bilingual proficiency', 'name': 'Serbian'}, {'levelCode': 4, 'code': 'en', 'level': 'Professional working proficiency', 'name': 'English'}, {'levelCode': 4, 'code': 'de', 'level': 'Professional working proficiency', 'name': 'German'}, {'levelCode': 4, 'code': 'hr', 'level': 'Full professional proficiency', 'name': 'Croatian'}], 'isFreelancer': False, 'jobs': [{'industryName': 'Other Sectors', 'jobTitle': 'Architect bei STADT WIEN - Wiener Wohnen Kundenservice GmbH', 'company': 'Stadt Wien - Wiener Wohnen Kundenservice GmbH', 'location': 'Vienna, Austria', 'industry': 'other sectors', 'companyURL': 'https://at.linkedin.com/company/stadt-wien-wiener-wohnen-kundenservice-gmbh', 'periodStart': '2021-01-01T00:00:00.000Z', 'industryCode': '019'}, {'industryName': 'Architecture and Planning', 'notes': 'Planung', 'jobTitle': 'Architect', 'company': 'awp architekten und ingenieure zt gmbh', 'location': 'Austria', 'industry': 'architecture and construction', 'periodStart': '2016-04-01T00:00:00.000Z', 'periodEnd': '2021-01-31T23:59:59.000Z', 'industryCode': '003'}, {'industryName': 'Energy, Water and Environment', 'notes': 'Planung, Design von Inneneinrichtungen,...', 'jobTitle': 'Architect', 'company': 'Lima Design', 'location': 'Vienna, Austria', 'industry': 'energy, water and environment', 'periodStart': '2014-08-01T00:00:00.000Z', 'periodEnd': '2016-04-30T23:59:59.000Z', 'industryCode': '011'}, {'notes': 'Interior design, furniture design, coordination with plans,...', 'jobTitle': 'Design von Inneneinrichtungen für Seniorenimmobilien', 'company': 'Pflegeraum Mayerling GmbH', 'periodStart': '2014-08-01T00:00:00.000Z', 'periodEnd': '2015-11-30T23:59:59.000Z'}, {'notes': 'Industrial and architectural metal contractor, exterior wall panel systems', 'jobTitle': 'Architectural Division Draftsman', 'company': 'John W. McDougall Company, Inc.', 'companyURL': 'https://www.linkedin.com/company/john-w-mcdougall-co-inc-', 'periodStart': '2011-05-01T00:00:00.000Z', 'periodEnd': '2013-11-30T23:59:59.000Z'}, {'notes': '• Urbanistic and tecnical conditions for commercial building 'Ekvator' Obilićevo, Banja Luka • Urbanistic and tecnical conditions for commercial building Obilićevo, Banja Luka • Regulation plan 'Donje Mladice',East Ilidža • Regulation plan 'Industrial zone Poljavnice', Novi Grad • Regulation plan 'Center' i 'Center West', Derventa (not completed)', 'jobTitle': 'Project architect in urbanism,architecture and research', 'company': 'Institute of Urbanism, Banja LukaProject architect in urbanism,architecture and research.', 'location': 'Banja Luka, Bosnia Hercegovina', 'periodStart': '2010-11-01T00:00:00.000Z', 'periodEnd': '2011-05-31T23:59:59.000Z'}, {'notes': '• Urbanistic and tecnical conditions and parcelation plan on building the highway Banja Luka – Doboj, Municipal territory Laktaši, Doboj and Derventa • Regulation plan 'Vrbas shore'', 'jobTitle': 'Internship', 'company': 'Architectural office 'Projekt' Banja Luka', 'periodStart': '2009-07-01T00:00:00.000Z', 'periodEnd': '2009-09-30T23:59:59.000Z'}, {'notes': '• Residential-commercial buiding (5 stories+attic) Bulevard Desanka Maksimović • Leagalization of residential and commercial buildings • Sport and recreation hall, Kozara quarters. • Sawmill , Novi Grad • Commercial complex 'Malta',Banja Luka', 'jobTitle': 'Project architect in planning and preparing tecnical documentation', 'company': 'Design bureau 'Kuća', Banja Luka', 'location': 'Banja Luka, Republic of Srpska, Bosnia Herzegovina', 'periodStart': '2004-02-01T00:00:00.000Z', 'periodEnd': '2007-06-30T23:59:59.000Z'}], 'isExecutive': False, 'fullName': 'Di Robert Majkic', 'previousIndustries': ['architecture and construction', 'energy, water and environment'], 'hasPhone': False, 'middleName': 'Robert', 'location': 'Vienna, Austria'}",
    "Lawyer - Bronislava Starovoitova": "{'_id': '5e6718539c655ba4ed3b427b', 'profileURL': 'https://www.xing.com/profile/Bronislava_Starovoitova', 'monthsInJob': 89, 'lastName': 'Starovoitova', 'mobility': 5, 'gender': 'f', 'jobTitle': 'Corporate Lawyer', 'changeProbability': 35, 'industry': 'Angestellt, Corporate Lawyer, PLL Legal&Crossborder', 'geoPoint': {'lon': 37.6174943, 'lat': 55.7504461}, 'monthsWorking': 89, 'hasEmail': False, 'lastUpdated': '2024-08-18T23:53:29.144Z', 'workingSince': '2017-04-01T00:00:00.000Z', 'isScientist': False, 'company': 'PLL Legal&Crossborder', 'isStudent': False, 'isRecruiter': False, 'altIds': ['aHR0cHM6Ly93d3cueGluZy5jb20vcHJvZmlsZS9Ccm9uaXNsYXZhX1N0YXJvdm9pdG92YQ', '5e6718539c655ba4ed3b427b'], 'address': {'country': 'Russia', 'city': 'Moscow', 'countryCode': 'ru', 'state': 'Moscow'}, 'lastScraped': '2024-08-18T14:17:49.570Z', 'scrapeSuccessCounter': 16, 'isFreelancer': False, 'jobs': [{'jobTitle': 'Corporate Lawyer', 'company': 'PLL Legal&Crossborder', 'companyURL': 'https://www.xing.com/pages/plllegal-cross-border', 'periodStart': '2017-04-01T00:00:00.000Z'}, {'industryName': 'Health and Wellness', 'jobTitle': 'Chief Legal Officer', 'company': 'iTech Capital', 'industry': 'health and welfare', 'industryCode': '014'}], 'hasFax': False, 'isExecutive': False, 'fullName': 'Bronislava Starovoitova', 'handle': 'bronislava_starovoitova', 'inJobSince': '2017-04-01T00:00:00.000Z', 'firstName': 'Bronislava', 'previousCompanies': ['iTech Capital'], 'ml5': {'similarProfiles': {'encoding': ['pos0cluster2', 'pos1cluster26', 'pos2cluster27', 'pos3cluster30', 'pos4cluster25', 'pos5cluster14', 'pos6cluster27', 'pos7cluster24', 'pos8cluster12', 'pos9cluster6', 'pos10cluster10', 'pos11cluster23', 'pos12cluster7', 'pos13cluster18', 'pos14cluster1', 'pos15cluster12', 'pos16cluster31', 'pos17cluster18', 'pos18cluster2', 'pos19cluster29']}, 'profileQuality': 1}, 'name': 'Bronislava Starovoitova', 'hasPhone': False, 'relevantLinksCount': 0, 'location': 'Moscow, Russian Federation', 'previousJobTitles': ['Chief Legal Officer'], '_class': 'xing', 'dateScrapedAtList': ['2023-02-14T10:35:17.767Z', '2023-03-06T22:51:30.600Z', '2023-03-24T03:33:23.714Z', '2023-04-14T02:51:05.573Z', '2023-04-19T21:37:07.446Z', '2023-04-26T21:11:02.870Z', '2023-05-02T10:35:36.411Z', '2023-05-29T12:30:52.408Z', '2023-07-02T06:03:41.738Z', '2023-08-02T05:26:13.236Z', '2023-10-27T22:34:27.351Z', '2023-12-03T02:34:45.054Z', '2024-01-13T22:12:00.274Z', '2024-03-25T16:04:03.338Z', '2024-06-02T05:52:37.620Z', '2024-08-18T14:17:49.570Z'], 'isConsultant': False}",
    "Civil engineer - Devin Muller": "{'_id': '55cef99fd4c657a8498a06e4', 'profileURL': 'https://stackexchange.com/users/5743452', 'lastName': 'Muller', 'mobility': 5, 'gender': 'm', 'changeProbability': 45, 'skills': ['steam', 'games', 'sd-card', 'chromebook'], 'hasEmail': False, 'lastUpdated': '2024-07-16T14:11:06.432Z', 'isScientist': False, 'imageURL': 'https://graph.facebook.com/818190908252829/picture?type=large', 'links': [{'name': 'facebook', 'handle': '818190908252829', 'url': 'http://facebook.com/818190908252829', 'platform': 'Facebook'}, {'name': 'Ask Ubuntu', 'url': 'https://askubuntu.com/users/375931'}], 'isStudent': False, 'isRecruiter': False, 'altIds': ['55cef99fd4c657a8498a06e4', 'aHR0cHM6Ly9zdGFja2V4Y2hhbmdlLmNvbS91c2Vycy81NzQzNDUy'], 'lastScraped': '2024-02-28T21:15:48.196Z', 'scrapeSuccessCounter': 11, 'isFreelancer': False, 'hasFax': False, 'isExecutive': False, 'fullName': 'Devin Muller', 'firstName': 'Devin', 'name': 'Devin Muller', 'hasPhone': False, 'relevantLinksCount': 0, '_class': 'stackexchange', 'dateScrapedAtList': ['2023-03-14T22:06:14.397Z', '2023-04-20T19:41:17.555Z', '2023-05-24T16:48:27.808Z', '2023-06-20T16:14:02.978Z', '2023-07-11T23:06:54.948Z', '2023-08-03T10:57:38.095Z', '2023-09-01T03:08:46.860Z', '2023-11-06T17:01:31.483Z', '2023-12-01T21:19:42.840Z', '2024-01-01T10:53:22.122Z', '2024-02-28T21:15:48.196Z'], 'idInPortal': '5743452', 'isConsultant': False}",
    "Nurse Practitioner - ": "{'_id': '5e65cf317b0968cfdc4e2e50', 'profileURL': 'https://www.xing.com/profile/Seana_Rutherford', 'monthsInJob': 111, 'lastName': 'Rutherford', 'mobility': 5, 'education': [{'school': 'Ursuline College', 'periodStart': '2012-08-01T00:00:00.000Z', 'periodEnd': '2015-05-31T23:59:59.000Z'}, {'school': 'University of Akron', 'periodStart': '2011-05-01T00:00:00.000Z', 'periodEnd': '2012-05-31T23:59:59.000Z'}], 'gender': 'f', 'jobTitle': 'Certified Nurse Practitioner', 'changeProbability': 35, 'industry': 'Angestellt, Certified Nurse Practitioner, Premier Physicians', 'geoPoint': {'lon': -81.6359612, 'lat': 41.5153289}, 'monthsWorking': 111, 'hasEmail': False, 'lastUpdated': '2024-08-19T01:42:29.784Z', 'workingSince': '2015-07-01T00:00:00.000Z', 'monthsEducation': 47, 'isScientist': False, 'imageURL': 'https://profile-images.xing.com/users/22113a380d42e2b67a67b2228a51afbb-1/image.256x256.jpg', 'company': 'Premier Physicians', 'isStudent': False, 'isRecruiter': False, 'altIds': ['aHR0cHM6Ly93d3cueGluZy5jb20vcHJvZmlsZS9TZWFuYV9SdXRoZXJmb3Jk', '5e65cf317b0968cfdc4e2e50'], 'address': {'country': 'United States', 'city': 'Cleveland', 'countryCode': 'us', 'state': 'Ohio'}, 'lastScraped': '2024-08-18T20:49:21.851Z', 'scrapeSuccessCounter': 16, 'isFreelancer': False, 'jobs': [{'jobTitle': 'Certified Nurse Practitioner', 'company': 'Premier Physicians', 'periodStart': '2015-07-01T00:00:00.000Z'}], 'hasFax': False, 'isExecutive': False, 'fullName': 'Seana Rutherford', 'handle': 'seana_rutherford', 'inJobSince': '2015-07-01T00:00:00.000Z', 'firstName': 'Seana', 'ml5': {'similarProfiles': {'encoding': ['pos0cluster27', 'pos1cluster15', 'pos2cluster24', 'pos3cluster12', 'pos4cluster11', 'pos5cluster9', 'pos6cluster1', 'pos7cluster20', 'pos8cluster27', 'pos9cluster1', 'pos10cluster8', 'pos11cluster15', 'pos12cluster25', 'pos13cluster29', 'pos14cluster12', 'pos15cluster23', 'pos16cluster20', 'pos17cluster25', 'pos18cluster4', 'pos19cluster20']}, 'profileQuality': 2}, 'name': 'Seana Rutherford', 'hasPhone': False, 'relevantLinksCount': 0, 'location': 'Cleveland, United States of America', '_class': 'xing', 'educationSince': '2011-05-01T00:00:00.000Z', 'dateScrapedAtList': ['2023-02-14T12:48:51.948Z', '2023-03-07T00:29:55.901Z', '2023-03-24T05:38:57.828Z', '2023-04-14T03:25:56.461Z', '2023-04-19T22:12:40.539Z', '2023-04-26T21:57:20.880Z', '2023-05-02T11:08:19.234Z', '2023-05-29T15:17:11.794Z', '2023-07-02T09:13:07.792Z', '2023-08-02T08:35:54.503Z', '2023-10-28T01:54:42.042Z', '2023-12-03T06:40:03.865Z', '2024-01-14T04:06:01.644Z', '2024-03-26T00:27:26.698Z', '2024-06-02T12:54:23.912Z', '2024-08-18T20:49:21.851Z'], 'isConsultant': False} ",
    "Accountant - Astghik Mikayelyan": "{'_id': '5f3d8950dea07610a83490e7', 'monthsInJob': 46, 'profileURL': 'https://www.xing.com/profile/Astghik_Mikayelyan', 'lastName': 'Mikayelyan', 'mobility': 25, 'education': [{'study': 'Financial Services Management', 'school': 'University of Applied Sciences Kaiserslautern', 'periodStart': '2020-03-01T00:00:00.000Z'}], 'gender': 'f', 'jobTitle': 'Finance Permanent Control Officer', 'changeProbability': 65, 'industry': 'Studentin, Financial Services Management, University of Applied Sciences Kaiserslautern', 'geoPoint': {'lon': 7.3641981, 'lat': 49.248655}, 'languagesString': 'English en Russian ru German de Armenian Native', 'monthsWorking': 71, 'skills': ['Accounting', 'Organizing (management)', 'IFRS', 'Procurement', 'Management Reporting', 'Microsoft Office Word', 'Microsoft Office Excel', 'Power Point', 'Marketing', 'Economics', 'Persuasive writing', 'Audit', 'Communication skills', 'EViews'], 'lastUpdated': '2024-08-06T22:59:21.322Z', 'hasEmail': False, 'workingSince': '2017-07-01T00:00:00.000Z', 'monthsEducation': 53, 'isScientist': False, 'imageURL': 'https://profile-images.xing.com/images/721f9645cba9dc2b7140ee93410df172-12/astghik-mikayelyan.256x256.jpg', 'company': 'Consors Finanz BNP Paribas', 'isStudent': False, 'isRecruiter': False, 'altIds': ['aHR0cHM6Ly93d3cueGluZy5jb20vcHJvZmlsZS9Bc3RnaGlrX01pa2F5ZWx5YW4', '5f3d8950dea07610a83490e7'], 'address': {'country': 'Germany', 'city': 'Zweibrücken', 'countryCode': 'de', 'state': 'Rhineland-Palatinate'}, 'lastScraped': '2024-08-06T19:53:20.573Z', 'scrapeSuccessCounter': 15, 'languages': [{'levelCode': 5, 'code': 'en', 'level': 'First language', 'name': 'English'}, {'levelCode': 5, 'code': 'ru', 'level': 'First language', 'name': 'Russian'}, {'levelCode': 2, 'code': 'de', 'level': 'Basic', 'name': 'German'}, {'name': 'Armenian Native'}], 'isFreelancer': False, 'hasFax': False, 'jobs': [{'industryName': 'Banks and Financial Services', 'jobTitle': 'Finance Permanent Control Officer', 'company': 'Consors Finanz BNP Paribas', 'industry': 'banks and financial services', 'companyURL': 'https://www.xing.com/pages/consorsfinanz', 'periodStart': '2020-10-01T00:00:00.000Z', 'industryCode': '007'}, {'industryName': 'Gambling and Casinos', 'notes': 'Gather and organize financial data from all accounting departments,prepare financial reports with reliable conclusions that management can use to implement more effective operations strategies. develop financial models, conduct bench marking and process analysis, conduct business studies on past, future and comparative performance and develop forecast models', 'jobTitle': 'Internal Auditor', 'company': 'BetConstruct', 'industry': 'gambling and casinos', 'periodStart': '2018-06-01T00:00:00.000Z', 'periodEnd': '2020-02-29T23:59:59.000Z', 'industryCode': '013'}, {'notes': 'Cost analysis, assisted in inputting all information related to procurement in MIS, assisted in preparing and managing procurement plans, assisted in preparing bidding documents, assisted in preparing the results of the procurement to be sent to the World Bank, USAID, ADB, EU, EBRD, SDC and the ATDF Board, have done contract management, prepared Financial Statement analysis of the ATDF project financed by the USAID', 'jobTitle': 'Intern', 'company': 'Armenian Territorial Development Fund', 'periodStart': '2018-02-01T00:00:00.000Z', 'periodEnd': '2018-04-30T23:59:59.000Z'}, {'industryName': 'Insurance', 'notes': 'Obtained an understanding about reconciling statement of financial position, and statement of profit and loss with sub-ledgers, enhanced my knowledge in IFRS and ISA, familiarized with the fellow up procedures of confirmation letters', 'jobTitle': 'Intern', 'company': 'KPMG Armenia', 'industry': 'insurance', 'periodStart': '2017-07-01T00:00:00.000Z', 'periodEnd': '2017-08-31T23:59:59.000Z', 'industryCode': '016'}], 'isExecutive': False, 'fullName': 'Astghik Mikayelyan', 'handle': 'astghik_mikayelyan', 'inJobSince': '2020-10-01T00:00:00.000Z', 'firstName': 'Astghik', 'previousCompanies': ['BetConstruct', 'Armenian Territorial Development Fund', 'KPMG Armenia'], 'ml5': {'similarProfiles': {'encoding': ['pos0cluster3', 'pos1cluster26', 'pos2cluster5', 'pos3cluster30', 'pos4cluster3', 'pos5cluster16', 'pos6cluster3', 'pos7cluster12', 'pos8cluster15', 'pos9cluster11', 'pos10cluster20', 'pos11cluster22', 'pos12cluster9', 'pos13cluster18', 'pos14cluster13', 'pos15cluster6', 'pos16cluster11', 'pos17cluster24', 'pos18cluster4', 'pos19cluster0']}, 'profileQuality': 4}, 'name': 'Astghik Mikayelyan', 'hasPhone': False, 'relevantLinksCount': 0, 'previousJobTitles': ['Internal Auditor', 'Intern'], 'location': 'zweibrucken, Germany', '_class': 'xing', 'educationSince': '2020-03-01T00:00:00.000Z', 'dateScrapedAtList': ['2023-03-01T13:28:54.538Z', '2023-03-20T10:47:45.185Z', '2023-04-13T00:53:53.931Z', '2023-04-18T17:46:49.461Z', '2023-04-25T16:30:15.576Z', '2023-04-30T18:03:11.251Z', '2023-05-22T18:52:30.250Z', '2023-06-26T11:27:28.580Z', '2023-07-27T01:46:16.884Z', '2023-10-21T13:38:20.430Z', '2023-11-24T11:57:53.809Z', '2024-01-06T02:19:00.394Z', '2024-03-10T11:59:27.135Z', '2024-05-19T23:28:44.771Z', '2024-08-06T19:53:20.573Z'], 'isConsultant': False}"
    }


def check_credentials(username, password):
    correct_password = os.getenv('USER_PASSWORD')
    return username == "talentwunder" and password == correct_password
 
                
if 'logged_in' not in st.session_state:
    st.session_state.logged_in = False
 
# Function to display the login form
def display_login_form():
    st.title("Login")
    with st.form("login_form"):
        username = st.text_input("Username")
        password = st.text_input("Password", type="password")
        login_button = st.form_submit_button("Login")
        if login_button:
            if check_credentials(username, password):
                st.session_state.logged_in = True
                st.success("Logged in successfully.")
                st.rerun()
            else:
                st.error("Incorrect username or password.")
                
def data_extraction(prompt, cv):
    completion = client.chat.completions.create(
                  model='gpt-4o',
                  temperature=0.9,
                  messages=[
                    {"role": "system", "content": prompt},
                    {"role": "user", "content": cv}
                ])
    
    generated_text = completion.choices[0].message.content  
    return generated_text
                
                
def display_main_app():
    st.title('AI Message Generator')
    selected_model = "gpt-4o"
    lang_option = st.selectbox(
    "Application language:",
    ("de", "en"))
    cv_option = st.selectbox(
        "Select a CV:",
        list(RESUMES.keys()))
    company_name = st.text_input("Enter your company name:")
    company_desc = st.text_area("Enter your company description:", height=50)
    job = st.text_area("Enter the job description:", height=50)
    person = st.text_input("Enter your name:")   
    cv = RESUMES[cv_option]
    format = "linkedin-message"
    maxMessageLengthInCharacters = 2500
    
    if 'generated_message' not in st.session_state:
        st.session_state.generated_message = None

    if st.button('Generate Message'):
        if company_name and company_desc and job and person:
            formatted_prompt = system_instruction.format(
                PERSON_NAME=person,
                COMPANY_NAME=company_name,
                COMPANY_DESCRIPTION=company_desc,
                JOB_DESCRIPTION=job,
                MAX_MESSAGE_LENGTH=maxMessageLengthInCharacters,
                FORMAT=format,
                LANG_OPTION=lang_option
            )
            with st.spinner('Generating text... Please wait'):
                gpt_output = data_extraction(formatted_prompt, cv)
                # Store the generated message in session state
                st.session_state.generated_message = gpt_output
                st.write(st.session_state.generated_message)
        else:
            st.error("Please fill in all the fields.")

    # If a message has been generated, show refinement options
    if st.session_state.generated_message:
        refinement = st.selectbox("Select a refinement:", list(REFINEMENTS.keys()))

        if st.button('Refine Message'):
            with st.spinner('Generating refined text... Please wait'):
                refined_prompt = refinement_prompt.format(
                    MESSAGE=st.session_state.generated_message,
                    REFINEMENT=refinement,
                    REFINEMENT_DESC=REFINEMENTS[refinement]
                )
                completion = client.chat.completions.create(
                    model=selected_model,
                    temperature=0.01,
                    messages=[{"role": "system", "content": refined_prompt}]
                )
                refined_output = completion.choices[0].message.content
                # Update the session state with the refined message
                st.title("Previous message:")
                st.write(st.session_state.generated_message)
                st.divider()
                st.title("Refined message:")
                st.write(refined_output)
                st.session_state.generated_message = refined_output
                
                
 
if not st.session_state.logged_in:
    display_login_form()
else:
    display_main_app()